<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    
    
    <link rel="shortcut icon" href="../../img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>Meridian_Unity - Meridian Information</title>
    <link href="../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../js/jquery-3.2.1.min.js"></script>
    <script src="../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "Meridian_Unity", url: "#_top", children: [
              {title: "UnityHub\u306b\u767b\u9332\u3057\u3066\u8d77\u52d5\u3059\u308b", url: "#unityhub" },
              {title: "Unity\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u306eIP\u30a2\u30c9\u30ec\u30b9\u3092\u66f8\u304d\u63db\u3048\u308b", url: "#unityip" },
              {title: "ESP32\u306eIP\u30a2\u30c9\u30ec\u30b9\u3092\u66f8\u304d\u63db\u3048\u308b", url: "#esp32ip" },
          ]},
        ];

    </script>
    <script src="../../js/base.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    

    <h1 id="meridian_unity"><a href="https://github.com/Ninagawa123/Meridian_Unity">Meridian_Unity</a><a class="headerlink" href="#meridian_unity" title="Permanent link">&para;</a></h1>
<p>MeridianをUnityで動作させるための簡易デモです.<br />
※Mac/Winで動作を確認しています. Winではファイアーウォールの設定が必要です.   </p>
<p>Meridianの詳細については下記をご参照ください.<br />
<a href="https://ninagawa123.github.io/Meridian_info/">Meridian_info</a> ...基本情報<br />
<a href="https://github.com/Ninagawa123/Meridian_TWIN">Meridian_TWIN</a> ...高機能版のボード情報<br />
<a href="https://github.com/Ninagawa123/Meridian_LITE">Meridian LITE</a> ...簡易版のボード情報  </p>
<h2 id="unityhub">UnityHubに登録して起動する<a class="headerlink" href="#unityhub" title="Permanent link">&para;</a></h2>
<p>フォルダ「Meridian_Unity_demo1」の中のMeridian_unity_demo_20220704.zipを解凍します. <br />
UnityHubを開き, ProjectsのADDで解凍済みの「Meridian_unity_demo_20220704」フォルダを指定します. <br />
UnityHubに登録されたらプロジェクトを起動します.（Unityのバージョンは2020.3.25f1(LTS)です） </p>
<h2 id="unityip">UnityのスクリプトのIPアドレスを書き換える<a class="headerlink" href="#unityip" title="Permanent link">&para;</a></h2>
<p>画面下の「Project」→「Assets」→「Script」よりUdp_handler_sendをダブルクリックして開きます.（VScodeなどが立ち上がります）<br />
スクリプト9行目のconst string HOST = "192.168.1.xx"; にESP32DevKitCのIPアドレスを記入し, セーブします. 　
(ESP32のIPアドレスはESP32をPCに接続した際にシリアルモニタに表示されます. 詳細は前述のボード情報をご参照ください.)  </p>
<h2 id="esp32ip">ESP32のIPアドレスを書き換える<a class="headerlink" href="#esp32ip" title="Permanent link">&para;</a></h2>
<p>これまでの手順で設定済みの場合はそのままでOKです.<br />
Meridian_TWINもしくはMeridian_LITEのESP32用ファイルのconfig.hに, Unityを使うPCのIPアドレスを入力します.  </p>
<h3 id="windows">Windowsの場合はファイアーウォールを設定する<a class="headerlink" href="#windows" title="Permanent link">&para;</a></h3>
<p>Windowsスタートメニュー→「設定」→「更新とセキュリティ」→「Windowsセキュリティ」→「ファイアーウォールとネットワーク保護」→「詳細設定」→「受信の規則」の一覧から「Unity 2020.3.25f1 Editor」の「パブリック」となっているものを選択しダブルクリック.「接続を許可する」にチェックを入れOKします. </p>
<h3 id="unitymeridian">UnityとMeridianボードを起動する<a class="headerlink" href="#unitymeridian" title="Permanent link">&para;</a></h3>
<p><img width="713" alt="SS 985" src="https://github.com/Ninagawa123/Meridian_Unity/assets/8329123/f9d9acb3-04d4-448b-be3d-c8904458f31e">  </p>
<p>Unityを起動した後, 「SampleScene」をダブルクリックし, 再生ボタンを押します.<br />
Meridianボードと通信が成立していればロボットの関節にシンクロして画面の中のモデルが動きます.  </p>
<p>画面の「Send」にチェックを入れるとUnityからロボットを操作することができます.<br />
スライドバーに対応したサーボが動きます。またスライドバーの上のテキストボックスに直接数値を入力することができます.<br />
数値の単位はdegreeとなります.  </p>
<p>「Action」にチェックを入れるとUnityからロボットにサンプルのモーションを送信します.<br />
左半身の各関節角度をsinカーブで増減させます.<br />
このモーションはParamMaster.csの160行目-167行目で設定しているので, 適宜書き換えてお試しください.  </p>
<h3 id="_1">トラブルシューティング<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h3>
<p>うまく接続できない場合, ESP32をテストモードに設定することで, ESP32単体とUnityの接続の確立のみに問題を絞ることができます.<br />
<a href="https://github.com/Ninagawa123/Meridian_LITE">Meridian LITE</a> を以下のように改定し, ESP32に書き込みます.<br />
- config.h内 #define ESP32_STDALONE 1 としてテストモードを有効にする.<br />
- keys.hにWifi設定も書き込む. この時, 接続先が2.4GHz帯となるように注意する.  </p>
<p>また, 当UnityファイルのUDP_SendHandler.csのConst String Host = ""にESP32のIPアドレスが正しく書き込まれているかを確認してください.  </p>
<p>ESP32はMeridian Boardに挿す必要はなく、ESP32DevkitC単体で試すことができます。<br />
ESP32に電源が供給され, かつUnityの再生ボタンが押された状態となれば接続が完了します.<br />
<img width="600" alt="SS 1071" src="https://github.com/Ninagawa123/Meridian_Unity/assets/8329123/bf4f53e0-c676-4926-af17-b79a60cd3c8b"><br />
接続が成功すると, ESP32側からL0番のサーボに+-30度のダミーデータが送信され, 首を左右に振るような動きになります. 機体の向きは画面に背を向けた状態になります.  </p>

  <br>
    

    <br>
</div>

<footer class="container-fluid wm-page-content">
  <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a> using <a href="https://github.com/gristlabs/mkdocs-windmill">Windmill</a> theme by Grist Labs.</p>
</footer>

</body>
</html>